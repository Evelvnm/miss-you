
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>立冬想你</title>
    <style>
        /* 全局样式：清除默认边距，统一字体 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "微软雅黑", sans-serif;
        }

        /* 背景图样式（完整显示，居中对齐） */
        body {
            background-image: url('love.jpg'); 
            background-size: contain;
            background-position: center center;
            background-attachment: fixed;
            background-repeat: no-repeat;
            min-height: 100vh;
        }

        /* 初始弹窗样式 */
        .initial-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 500px;
            height: 200px;
            background: linear-gradient(135deg, #FF69B4, #FF85C1);
            border: none;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(255, 105, 180, 0.4);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: fadeIn 0.5s ease-in-out;
        }

        .initial-text {
            font-size: 20px;
            font-weight: bold;
            color: #000000;
            margin-bottom: 25px;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .initial-btn {
            padding: 10px 30px;
            font-size: 14px;
            background-color: #000000;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .initial-btn:hover {
            transform: scale(1.05);
            background-color: #333;
        }

        /* 随机小弹窗样式 */
        .random-popup {
            position: fixed;
            width: 280px;
            max-width: 90%;
            height: 70px;
            border: none;
            border-radius: 15px;
            box-shadow: 0 6px 25px rgba(0,0,0,0.18);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 999;
            animation: popIn 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            overflow: hidden;
            transition: all 1.5s ease-in-out;
        }

        .random-text {
            font-size: 14px;
            line-height: 1.6;
            color: #000000;
            text-align: center;
            width: 90%;
            max-width: 240px;
        }

        /* 浮窗关闭按钮（颜色调浅） */
        .close-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 20px;
            height: 20px;
            background-color: rgba(0,0,0,0.3); /* 透明度从0.5降为0.3，颜色更浅 */
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.2s;
        }
        .random-popup:hover .close-btn {
            opacity: 1;
        }

        /* 动画定义 */
        @keyframes fadeIn {
            from { opacity: 0; transform: translate(-50%, -60%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
        }
        @keyframes popIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        /* 移动端适配 */
        @media (max-width: 400px) {
            .random-popup {
                width: 240px;
                height: 60px;
            }
            .random-text {
                font-size: 13px;
            }
        }

        /* 音乐控制按钮 */
        .music-control {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 1000;
        }
    </style>
</head>
<body>
    <!-- 背景音乐 -->
    <audio id="bgMusic" loop>
        <source src="恶作剧.aac" type="audio/aac">
    </audio>

    <!-- 音乐控制按钮 -->
    <div class="music-control" id="musicControl">
        ▶
    </div>

    <!-- 初始弹窗 -->
    <div class="initial-popup" id="initialPopup">
        <div class="initial-text">立冬快乐呀～</div>
        <button class="initial-btn" id="startBtn">知道啦</button>
    </div>

    <script>
        // 立冬专属文案
        const tips = [
            "立冬快乐",
            "岁至立冬",
            "天冷了，多穿衣服（可能你们那边没那么冷哈）",
            "冬日如愿，科二必过",
            "按时吃饭，多多喝水，好好想我",
            "保持微笑呀",
            "每天都要元气满满呀",
            "愿你的冬天，天不寒日日暖，暖在心中",
            "寒来暑往，秋收冬藏",
            "保持好心情，我一直在",
            "好好照顾自己，要不然我真的会心疼",
            "我想你了，超级超级超级想",
            "期待和你下一次见面",
            "所有美好也如期而至",
            "别太累啦，偶尔偷懒也好，我一直在哦",
            "你是最最最最最最最最棒的",
            "珍惜和你每一刻",
            "顺顺利利",
            "立冬快乐",
            "愿所有烦恼都消失",
            "你超级美，超级好看，超级可爱",
            "今天过得开心嘛"
        ];

        // 随机亮色生成逻辑（修改为带透明度的rgba格式）
        function getRandomColor() {
            const channel = ["r", "g", "b"][Math.floor(Math.random() * 3)];
            let r = 0, g = 0, b = 0;
            if (channel === "r") {
                r = Math.floor(Math.random() * 36) + 220;
                g = Math.floor(Math.random() * 101) + 50;
                b = Math.floor(Math.random() * 101) + 50;
            } else if (channel === "g") {
                r = Math.floor(Math.random() * 101) + 50;
                g = Math.floor(Math.random() * 36) + 220;
                b = Math.floor(Math.random() * 101) + 50;
            } else {
                r = Math.floor(Math.random() * 101) + 50;
                g = Math.floor(Math.random() * 101) + 50;
                b = Math.floor(Math.random() * 36) + 220;
            }
            // 最后一个参数0.7为透明度（0-1之间，值越小越透明），可根据需求调整
            return `rgba(${r}, ${g}, ${b}, 0.7)`;
        }

        // 生成爱心形状的坐标点（优化居中与对称）
        function getHeartPosition(index, total, scale = 1) {
            const t = (index / total) * Math.PI * 2;
            const x = 16 * Math.pow(Math.sin(t), 3);
            const y = 13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t);
            
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;
            
            // 调整缩放和偏移，确保爱心居中且对称
            const scaleFactor = Math.min(window.innerWidth, window.innerHeight) / 32 * scale;
            const offsetX = (Math.random() - 0.5) * 15;
            const offsetY = (Math.random() - 0.5) * 15;
            
            return {
                x: centerX + x * scaleFactor + offsetX,
                y: centerY - y * scaleFactor + offsetY
            };
        }

        // 弹窗逻辑（调整弹出速度）
        let totalPops = 120; 
        let currentPop = 0;
        let delay = 100; // 弹窗弹出速度适中
        let popupList = [];
        let isHeartFormed = false;

        function createRandomPopup() {
            if (currentPop < totalPops) {
                const randomContent = tips[Math.floor(Math.random() * tips.length)];
                const randomBg = getRandomColor();
                
                const randomX = Math.floor(Math.random() * (window.innerWidth - 280));
                const randomY = Math.floor(Math.random() * (window.innerHeight - 70));

                const popElem = document.createElement("div");
                popElem.className = "random-popup";
                popElem.style.backgroundColor = randomBg;
                popElem.style.left = `${randomX}px`;
                popElem.style.top = `${randomY}px`;
                popElem.dataset.index = currentPop;

                const textElem = document.createElement("div");
                textElem.className = "random-text";
                textElem.textContent = randomContent;
                popElem.appendChild(textElem);

                const closeBtn = document.createElement("div");
                closeBtn.className = "close-btn";
                closeBtn.textContent = "×";
                closeBtn.onclick = () => {
                    popElem.remove();
                    popupList = popupList.filter(item => item !== popElem);
                };
                popElem.appendChild(closeBtn);

                document.body.appendChild(popElem);
                popupList.push(popElem);

                currentPop++;
                setTimeout(createRandomPopup, delay);
                
                if (currentPop === totalPops) {
                    setTimeout(formHeartShape, 1000);
                }
            }
        }

        // 组成爱心形状
        function formHeartShape() {
            isHeartFormed = true;
            popupList.forEach((pop, index) => {
                const heartPos = getHeartPosition(index, popupList.length, 0.9);
                
                const maxX = window.innerWidth - pop.offsetWidth;
                const maxY = window.innerHeight - pop.offsetHeight;
                const finalX = Math.max(0, Math.min(heartPos.x, maxX));
                const finalY = Math.max(0, Math.min(heartPos.y, maxY));
                
                pop.style.left = `${finalX}px`;
                pop.style.top = `${finalY}px`;
            });
        }

        // 全部关闭按钮
        function createCloseAllBtn() {
            const closeAllBtn = document.createElement("button");
            closeAllBtn.style.position = "fixed";
            closeAllBtn.style.bottom = "20px";
            closeAllBtn.style.right = "20px";
            closeAllBtn.style.padding = "10px 20px";
            closeAllBtn.style.backgroundColor = "rgba(0,0,0,0.8)";
            closeAllBtn.style.color = "white";
            closeAllBtn.style.border = "none";
            closeAllBtn.style.borderRadius = "8px";
            closeAllBtn.style.fontSize = "14px";
            closeAllBtn.style.cursor = "pointer";
            closeAllBtn.textContent = "全部关闭";
            closeAllBtn.onclick = () => {
                popupList.forEach(pop => pop.remove());
                popupList = [];
            };
            document.body.appendChild(closeAllBtn);
        }

        // 音乐控制
        const music = document.getElementById('bgMusic');
        const musicControl = document.getElementById('musicControl');
        
        musicControl.addEventListener('click', () => {
            if (music.paused) {
                music.play().catch(e => {
                    console.log('播放失败:', e);
                    alert('请点击页面任意位置以允许播放音乐');
                });
                musicControl.textContent = "⏸";
            } else {
                music.pause();
                musicControl.textContent = "▶";
            }
        });

        document.body.addEventListener('click', () => {
            if (music.paused) {
                music.play().catch(e => console.log('自动播放失败，需要用户交互'));
            }
        }, { once: true });

        // 窗口大小改变时重排爱心
        window.addEventListener('resize', () => {
            if (isHeartFormed) {
                formHeartShape();
            }
        });

        // 初始弹窗点击事件
        document.getElementById("startBtn").addEventListener("click", () => {
            document.getElementById("initialPopup").remove();
            createRandomPopup();
            createCloseAllBtn();
            music.play().catch(e => console.log('需要用户交互才能播放音乐'));
        });
    </script>
</body>
</html>
